<!DOCTYPE html>
<html>
  <head>
     <base target="_top" />
     <style>
input{
  width: 40%;
  padding: 12px 20px;
  margin: 8px 0;
  display: inline-block;
  border: 1px solid #ccc;
  border-radius: 4px;
  box-sizing: border-box;
}
</style>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
  </head>
  <body align="center">
    <div class="containner">
      <div class="row">
        <div class="col-12 text-center">
               <h2 class="alert alert-info">ระบบค้นหาเกียรติบัตร</h2>
               <div class="col-12 mb-3 ">ห้องสมุดประชาชนอำเภอหนองหญ้าปล้อง จังหวัดเพชรบุรี</div>
               <div class="col-lg-12">
                   <img src="https://lh3.googleusercontent.com/drive-viewer/AKGpihYeAg6UPp64pVveWbdu41OFPxgdIt7W9SuE-YDeMgt_YqBPCxHHINd-mAm-CLWPexCvOGVdjmeYxoEod8CNtr5TAfr_RzHkQTE=s1600-rw-v1" class="img-fluid img-thumbnail mb-2" width="500px;">
</div>
               <div class="col-lg-12">
    <input type="text"id="id" class="form-contorl col-10 col-md-10 col-lg-6" placeholder="กรอกอีเมล" onkeypress="checkEnter()"/>
    <br>
    <input type="submit" class="btn btn-success mt-2"  value="ค้นหา" onclick="info()" />
    </div>
    <hr><center>
      <div class="containner">
        <div class="row">
          <div class="col-lg-12">
    <div id="result"></div>
    </div>
    </div>
    </div>
    </div>
    </div>
    </div>
    </center>
      <script>
      function  info () {
        let obj = document.querySelector('#id').value;
        let updateLocation = document.querySelector('#result');
        updateLocation.innerHTML = "กำลังค้นหา...";

        function onFailure(error){
          let warning = "<span style='color:red'>"+error+"</span>";
          updateLocation.innerHTML = warning;
        };
        
        function onSuccess(response){
          let result ="<span style='color:blue'>"+response+"</span>";
          updateLocation.innerHTML = result;
        };
        google.script.run.withFailureHandler(onFailure)
                         .withSuccessHandler(onSuccess)
                         .submitData(obj);
      };
      function checkEnter(e){
        if(event.keyCode==13){info();};
      }
    </script>
    
  </body>
</html>
